<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£ - ‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏ö‡∏≥‡∏£‡∏≤‡∏®‡∏ô‡∏£‡∏≤‡∏î‡∏π‡∏£</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700;800&display=swap');
        
        body { 
            font-family: 'Sarabun', sans-serif; 
            font-size: 18px;
            line-height: 1.6;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .form-section {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.75rem;
            font-size: 1rem;
        }
        
        .form-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.95);
            font-weight: 500;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #f8b4cb;
            box-shadow: 0 0 0 4px rgba(248, 180, 203, 0.25);
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-12px); }
            60% { transform: translateY(-6px); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }
        
        .animate-bounce { animation: bounce 2s infinite; }
        .animate-pulse { animation: pulse 2s infinite; }
        .animate-rotate { animation: rotate 3s linear infinite; }
        .animate-float { animation: float 3s ease-in-out infinite; }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
        }
        
        .modal-content {
            background: linear-gradient(135deg, #fef7ff 0%, #f3e8ff 100%);
            margin: 2% auto;
            padding: 2.5rem;
            border-radius: 20px;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #f8b4cb 0%, #c084fc 100%);
            color: #1f2937;
            font-weight: 700;
            font-size: 1.125rem;
            padding: 1.25rem 2rem;
            border-radius: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(248, 180, 203, 0.4);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(248, 180, 203, 0.6);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #1f2937;
            font-weight: 700;
            font-size: 1.125rem;
            padding: 1.25rem 2rem;
            border-radius: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.4);
        }
        
        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(251, 191, 36, 0.6);
        }
        
        .header-title {
            font-size: 2rem;
            font-weight: 800;
            color: #1e40af;
        }
        
        .header-subtitle {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e3a8a;
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            body {
                font-size: 14px;
                line-height: 1.4;
            }
            
            .form-section {
                padding: 1rem;
                margin-bottom: 1rem;
                border-radius: 12px;
            }
            
            .modal-content {
                margin: 2% auto;
                padding: 1rem;
                width: 98%;
                max-height: 95vh;
            }
            
            .section-title {
                font-size: 1.1rem;
                margin-bottom: 1rem;
            }
            
            .header-title {
                font-size: 1.3rem;
            }
            
            .header-subtitle {
                font-size: 0.9rem;
            }
            
            .form-input {
                padding: 0.75rem;
                font-size: 0.9rem;
                border-radius: 8px;
            }
            
            .form-label {
                font-size: 0.85rem;
                margin-bottom: 0.5rem;
            }
            
            .btn-primary, .btn-secondary {
                padding: 1rem 1.5rem;
                font-size: 1rem;
                border-radius: 12px;
            }
            
            .grid {
                gap: 0.75rem;
            }
            
            .container {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            
            /* Optimize image previews for mobile */
            .image-preview {
                width: 120px;
                height: 120px;
            }
            
            /* Faster animations on mobile */
            .animate-bounce, .animate-pulse, .animate-rotate, .animate-float {
                animation-duration: 1s;
            }
            
            /* Reduce backdrop blur for better performance */
            .glass-effect {
                backdrop-filter: blur(8px);
            }
            
            /* Optimize modal for mobile */
            .modal {
                backdrop-filter: blur(4px);
            }
        }
        
        /* Performance optimizations */
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        .form-input {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
        
        /* Lazy loading for images */
        .image-preview {
            loading: lazy;
        }
        
        /* Reduce repaints */
        .form-section {
            will-change: transform;
        }
        
        .image-preview {
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .image-preview:hover {
            transform: scale(1.05);
        }
        
        .status-indicator {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #f8b4cb;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-emerald-50 via-teal-50 to-cyan-100">

    <!-- Header -->
    <header class="glass-effect p-6 mb-10">
        <div class="container mx-auto flex items-center justify-center">
            <div class="flex items-center space-x-6">
                <i class="fas fa-hospital text-blue-600 text-4xl animate-pulse"></i>
                <div class="text-center">
                    <h1 class="header-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£</h1>
                    <p class="header-subtitle">‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏ö‡∏≥‡∏£‡∏≤‡∏®‡∏ô‡∏£‡∏≤‡∏î‡∏π‡∏£</p>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4">
        <!-- Registration Form -->
        <div id="registrationForm" class="fade-in">
            <div class="max-w-7xl mx-auto px-4">
                <form id="staffForm">
                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i class="fas fa-user text-pink-500 animate-bounce"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-id-card text-blue-500 mr-3"></i>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô *</label>
                                <input type="text" name="idCard" required class="form-input" maxlength="13" placeholder="1234567890123">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-user-tag text-purple-500 mr-3"></i>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ *</label>
                                <select name="prefix" required class="form-input">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</option>
                                    <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                                    <option value="‡∏ô‡∏≤‡∏á">‡∏ô‡∏≤‡∏á</option>
                                    <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                                    <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-signature text-pink-500 mr-3"></i>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                                <input type="text" name="fullName" required class="form-input" placeholder="‡∏ä‡∏∑‡πà‡∏≠ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-birthday-cake text-orange-500 mr-3"></i>‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î *</label>
                                <input type="date" name="birthDate" required class="form-input" onchange="calculateAge()">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-phone text-green-500 mr-3"></i>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                                <input type="tel" name="phone" class="form-input" placeholder="08xxxxxxxx" maxlength="10">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-envelope text-red-500 mr-3"></i>‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏•‡πå</label>
                                <input type="email" name="email" class="form-input" placeholder="example@email.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-calendar-alt text-indigo-500 mr-3"></i>‡∏≠‡∏≤‡∏¢‡∏∏</label>
                                <input type="number" name="age" class="form-input bg-gray-100" readonly placeholder="‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-hourglass-end text-amber-500 mr-3"></i>‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì‡∏≠‡∏≤‡∏¢‡∏∏‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</label>
                                <input type="number" name="retirementYear" class="form-input bg-gray-100" readonly placeholder="‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥">
                            </div>
                        </div>
                        <div class="form-group mt-6">
                            <label class="form-label"><i class="fas fa-camera text-cyan-500 mr-3"></i>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</label>
                            <input type="file" name="personalImage" accept="image/*" class="form-input" onchange="previewImage(this, 'personalImagePreview', 'personalImageStatus')">
                            <div id="personalImagePreview" class="mt-4"></div>
                            <div id="personalImageStatus" class="mt-2"></div>
                        </div>
                    </div>

                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i class="fas fa-briefcase text-purple-600 animate-pulse"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-building text-blue-600 mr-3"></i>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</label>
                                <select name="department" class="form-input">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-user-tie text-indigo-600 mr-3"></i>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                                <select name="position" class="form-input">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-hashtag text-purple-600 mr-3"></i>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                                <input type="text" name="positionNumber" class="form-input" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-layer-group text-teal-600 mr-3"></i>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                                <select name="positionLevel" class="form-input">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-tags text-emerald-600 mr-3"></i>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                                <select name="positionType" class="form-input">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-star text-yellow-600 mr-3"></i>‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç‡∏Ç‡∏≠‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                                <select name="expertise" class="form-input">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i class="fas fa-certificate text-emerald-500 animate-rotate"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-id-badge text-blue-500 mr-3"></i>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û</label>
                                <input type="text" name="licenseNumber" class="form-input" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-user-nurse text-pink-500 mr-3"></i>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡∏†‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</label>
                                <input type="text" name="nursingCouncilNumber" class="form-input" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-calendar-times text-red-500 mr-3"></i>‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û</label>
                                <input type="date" name="licenseExpiry" class="form-input">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-play-circle text-green-500 mr-3"></i>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</label>
                                <input type="date" name="startDate" class="form-input" onchange="calculateWorkExperience()">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-clock text-orange-500 mr-3"></i>‡∏≠‡∏≤‡∏¢‡∏∏‡∏á‡∏≤‡∏ô</label>
                                <input type="text" name="workExperience" class="form-input bg-gray-100" readonly placeholder="‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-calendar-check text-purple-500 mr-3"></i>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</label>
                                <input type="date" name="appointmentDate" class="form-input">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-medal text-yellow-500 mr-3"></i>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏≥‡∏£‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç‡∏Å‡∏≤‡∏£</label>
                                <input type="date" name="specialistDate" class="form-input">
                            </div>
                        </div>
                        <div class="form-group mt-6">
                            <label class="form-label"><i class="fas fa-file-medical text-teal-500 mr-3"></i>‡πÅ‡∏ô‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û</label>
                            <input type="file" name="licenseDocument" accept="image/*,.pdf" class="form-input" onchange="previewImage(this, 'licenseDocumentPreview', 'licenseDocumentStatus')">
                            <div id="licenseDocumentPreview" class="mt-4"></div>
                            <div id="licenseDocumentStatus" class="mt-2"></div>
                        </div>
                    </div>

                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i class="fas fa-graduation-cap text-indigo-600 animate-float"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-university text-blue-600 mr-3"></i>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</label>
                                <select name="educationLevel" class="form-input">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-graduation-cap text-green-600 mr-3"></i>‡∏ß‡∏∏‡∏í‡∏¥‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ ‡∏™‡∏≤‡∏Ç‡∏≤</label>
                                <input type="text" name="bachelorField" class="form-input" placeholder="‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-user-graduate text-purple-600 mr-3"></i>‡∏ß‡∏∏‡∏í‡∏¥‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡πÇ‡∏ó ‡∏™‡∏≤‡∏Ç‡∏≤</label>
                                <input type="text" name="masterField" class="form-input" placeholder="‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤">
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-crown text-yellow-600 mr-3"></i>‡∏ß‡∏∏‡∏í‡∏¥‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡πÄ‡∏≠‡∏Å ‡∏™‡∏≤‡∏Ç‡∏≤</label>
                                <input type="text" name="doctoralField" class="form-input" placeholder="‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-stethoscope text-pink-600 mr-3"></i>‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á‡∏™‡∏≤‡∏Ç‡∏≤</label>
                            <input type="text" name="specializedNursing" class="form-input" placeholder="‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á">
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-scroll text-indigo-500 mr-3"></i>‡πÅ‡∏ô‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label>
                                <input type="file" name="educationDocument" accept="image/*,.pdf" class="form-input" onchange="previewImage(this, 'educationDocumentPreview', 'educationDocumentStatus')">
                                <div id="educationDocumentPreview" class="mt-4"></div>
                                <div id="educationDocumentStatus" class="mt-2"></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label"><i class="fas fa-certificate text-amber-500 mr-3"></i>‡πÅ‡∏ô‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ß‡∏∏‡∏í‡∏¥‡∏ö‡∏±‡∏ï‡∏£</label>
                                <input type="file" name="specializedDocument" accept="image/*,.pdf" class="form-input" onchange="previewImage(this, 'specializedDocumentPreview', 'specializedDocumentStatus')">
                                <div id="specializedDocumentPreview" class="mt-4"></div>
                                <div id="specializedDocumentStatus" class="mt-2"></div>
                            </div>
                        </div>
                    </div>

                    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i class="fas fa-info-circle text-orange-500 animate-pulse"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
                        </h3>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-clipboard-list text-teal-600 mr-3"></i>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤/‡∏≠‡∏≠‡∏Å‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏ö‡∏≥‡∏£‡∏≤‡∏®‡∏ô‡∏£‡∏≤‡∏î‡∏π‡∏£</label>
                            <input type="text" name="workType" class="form-input" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô">
                        </div>
                    </div>

                    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å -->
                    <div class="form-section">
                        <div class="flex gap-6">
                            <button type="submit" class="flex-1 btn-primary flex items-center justify-center">
                                <i class="fas fa-save mr-4 animate-bounce text-yellow-600 text-xl"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </button>
                            <button type="button" id="clearFormBtn" onclick="clearForm()" class="flex-1 btn-secondary flex items-center justify-center" style="display: none;">
                                <i class="fas fa-broom mr-4 text-blue-600 text-xl"></i>‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Data Details Modal -->
        <div id="dataModal" class="modal">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 flex items-center">
                        <i class="fas fa-user-check text-emerald-500 mr-4 animate-bounce"></i>
                        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß
                    </h2>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-3xl">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="modalContent" class="space-y-6">
                    <!-- Content will be populated by JavaScript -->
                </div>
                <div class="flex gap-6 mt-8">
                    <button onclick="editData()" class="flex-1 btn-primary flex items-center justify-center">
                        <i class="fas fa-edit mr-3 animate-pulse text-yellow-300 text-lg"></i>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </button>
                    <button onclick="closeModal()" class="flex-1 btn-secondary flex items-center justify-center">
                        <i class="fas fa-check mr-3 text-green-400 text-lg"></i>‡∏õ‡∏¥‡∏î
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script>
    <script>
    // CONFIG
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwettDCjvdFPKV4dk_Kl0zwzN7kIVfchsmKgIEAwcQNgWIZyrU6Ecb8RQrjyBx3IAg57A/exec';

    let dropdownData = {
        departments: [],
        positions: [],
        positionLevels: [],
        positionTypes: [],
        positionExpertise: [],
        education: [],
        workTypes: []
    };

    // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô dropdown ==========
    async function loadDropdownData() {
        try {
            // fetch dropdown ‡∏à‡∏≤‡∏Å GAS
            const response = await fetch(SCRIPT_URL + '?action=getDropdownData');
            const data = await response.json();
            if (data.success) dropdownData = data.data;
        } catch (e) {
            dropdownData = {};
        }
        populateDropdowns();
    }
    function populateDropdowns() {
        // department
        const departmentSelect = document.querySelector('select[name="department"]');
        if (departmentSelect) {
            departmentSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</option>';
            (dropdownData.departments || []).forEach(dept => {
                departmentSelect.innerHTML += `<option value="${dept}">${dept}</option>`;
            });
        }
        // position
        const positionSelect = document.querySelector('select[name="position"]');
        if (positionSelect) {
            positionSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option>';
            (dropdownData.positions || []).forEach(pos => {
                positionSelect.innerHTML += `<option value="${pos}">${pos}</option>`;
            });
        }
        // positionLevel
        const positionLevelSelect = document.querySelector('select[name="positionLevel"]');
        if (positionLevelSelect) {
            positionLevelSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option>';
            (dropdownData.positionLevels || []).forEach(level => {
                positionLevelSelect.innerHTML += `<option value="${level}">${level}</option>`;
            });
        }
        // positionType
        const positionTypeSelect = document.querySelector('select[name="positionType"]');
        if (positionTypeSelect) {
            positionTypeSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</option>';
            (dropdownData.positionTypes || []).forEach(type => {
                positionTypeSelect.innerHTML += `<option value="${type}">${type}</option>`;
            });
        }
        // expertise
        const expertiseSelect = document.querySelector('select[name="expertise"]');
        if (expertiseSelect) {
            expertiseSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç</option>';
            (dropdownData.positionExpertise || []).forEach(exp => {
                expertiseSelect.innerHTML += `<option value="${exp}">${exp}</option>`;
            });
        }
        // educationLevel
        const educationSelect = document.querySelector('select[name="educationLevel"]');
        if (educationSelect) {
            educationSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>';
            (dropdownData.education || []).forEach(edu => {
                educationSelect.innerHTML += `<option value="${edu}">${edu}</option>`;
            });
        }
    }

    // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô preview ==========
    function previewImage(input, previewId, statusId) {
        const preview = document.getElementById(previewId);
        const status = document.getElementById(statusId);
        if (input.files && input.files[0]) {
            const file = input.files[0];
            const fileSize = file.size;
            let color = 'üü¢', klass = 'bg-green-100 text-green-800', text = '‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°';
            if (fileSize >= 1000000) { color = 'üî¥'; klass = 'bg-red-100 text-red-800'; text = '‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏ç‡πà - ‡∏à‡∏∞‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥'; }
            else if (fileSize >= 500000) { color = 'üü°'; klass = 'bg-yellow-100 text-yellow-800'; text = '‡πÑ‡∏ü‡∏•‡πå‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á'; }
            status.innerHTML = `<div class="status-indicator ${klass} flex items-center space-x-3">
                <span class="text-xl">${color}</span>
                <div><div class="font-semibold">${(fileSize/1024/1024).toFixed(2)} MB</div>
                <div class="text-sm">${text}</div></div></div>`;
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `<div class="flex justify-center"><img src="${e.target.result}" alt="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û" class="image-preview w-40 h-40 object-cover"></div>`;
                };
                reader.readAsDataURL(file);
            } else {
                preview.innerHTML = `<div class="flex justify-center"><div class="w-40 h-40 bg-gray-100 rounded-lg border-2 border-gray-300 shadow-lg flex items-center justify-center"><i class="fas fa-file-pdf text-red-500 text-5xl"></i></div></div>`;
            }
        } else {
            preview.innerHTML = ''; status.innerHTML = '';
        }
    }

    // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô clearForm ==========
    function clearForm() {
        Swal.fire({
            title: '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?',
            text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#ef4444',
            cancelButtonColor: '#6b7280',
            confirmButtonText: '‡πÉ‡∏ä‡πà ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
            cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
        }).then((result) => {
            if (result.isConfirmed) {
                document.getElementById('staffForm').reset();
                document.getElementById('personalImagePreview').innerHTML = '';
                document.getElementById('personalImageStatus').innerHTML = '';
                document.getElementById('licenseDocumentPreview').innerHTML = '';
                document.getElementById('licenseDocumentStatus').innerHTML = '';
                document.getElementById('educationDocumentPreview').innerHTML = '';
                document.getElementById('educationDocumentStatus').innerHTML = '';
                document.getElementById('specializedDocumentPreview').innerHTML = '';
                document.getElementById('specializedDocumentStatus').innerHTML = '';
                window.isUpdateMode = false;
                window.hasSubmittedBefore = false;
                window.currentData = null;
                const submitButton = document.querySelector('button[type="submit"]');
                submitButton.innerHTML = '<i class="fas fa-save mr-4 animate-bounce text-yellow-600 text-xl"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                submitButton.className = 'flex-1 btn-primary flex items-center justify-center';
                document.getElementById('clearFormBtn').style.display = 'none';
                Swal.fire({
                    icon: 'success',
                    title: '‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!',
                    text: '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà',
                    confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                    confirmButtonColor: '#10b981'
                });
            }
        });
    }

    // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô editData ==========
    function editData() {
        if (window.currentData) {
            const form = document.getElementById('staffForm');
            Object.keys(window.currentData).forEach(key => {
                const input = form.querySelector(`[name="${key}"]`);
                if (input && window.currentData[key]) {
                    input.value = window.currentData[key];
                }
            });
            if (window.currentData.birthDate) calculateAge();
            if (window.currentData.startWorkDate) calculateWorkExperience();
            const submitButton = document.querySelector('button[type="submit"]');
            submitButton.innerHTML = '<i class="fas fa-sync-alt mr-3 animate-spin text-yellow-600"></i>‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            submitButton.className = 'flex-1 bg-gradient-to-r from-orange-300 to-red-300 hover:from-orange-400 hover:to-red-400 text-black font-semibold py-4 px-6 rounded-lg transition-all duration-300 flex items-center justify-center text-lg shadow-lg';
            window.isUpdateMode = true;
            closeModal();
            document.getElementById('registrationForm').scrollIntoView({ behavior: 'smooth' });
            Swal.fire({
                icon: 'info',
                title: '‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ',
                confirmButtonText: '‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß',
                confirmButtonColor: '#f8b4cb'
            });
        }
    }

    // ========== Modal functions ==========
    function showDataModal(data) {
        const modal = document.getElementById('dataModal');
        const modalContent = document.getElementById('modalContent');
        const fieldLabels = {
            idCard: '‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô',
            prefix: '‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤',
            fullName: '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•',
            birthDate: '‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î',
            age: '‡∏≠‡∏≤‡∏¢‡∏∏',
            phone: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå',
            email: '‡∏≠‡∏µ‡πÄ‡∏°‡∏•',
            department: '‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô',
            position: '‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á',
            positionNumber: '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á',
            positionLevel: '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á',
            positionType: '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á',
            expertise: '‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç',
            licenseNumber: '‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û',
            nursingCouncilNumber: '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡∏†‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•',
            licenseExpiry: '‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û',
            startDate: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô',
            appointmentDate: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£',
            specialistDate: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏≥‡∏£‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç‡∏Å‡∏≤‡∏£',
            retirementYear: '‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì‡∏≠‡∏≤‡∏¢‡∏∏‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£',
            education: '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤',
            bachelorField: '‡∏ß‡∏∏‡∏í‡∏¥‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ',
            masterField: '‡∏ß‡∏∏‡∏í‡∏¥‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡πÇ‡∏ó',
            doctoralField: '‡∏ß‡∏∏‡∏í‡∏¥‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡πÄ‡∏≠‡∏Å',
            specializedNursing: '‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á',
            workType: '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô',
            workExperience: '‡∏≠‡∏≤‡∏¢‡∏∏‡∏á‡∏≤‡∏ô'
        };
        let content = '<div class="grid grid-cols-1 md:grid-cols-2 gap-6">';
        Object.keys(fieldLabels).forEach(key => {
            if (data[key] && data[key] !== '') {
                content += `<div class="bg-white p-4 rounded-xl border-2 border-pink-200 shadow-sm">
                    <div class="text-sm text-gray-600 font-semibold mb-1">${fieldLabels[key]}</div>
                    <div class="text-gray-800 font-medium text-lg">${data[key]}</div>
                </div>`;
            }
        });
        content += '</div>';
        modalContent.innerHTML = content;
        modal.style.display = 'block';
    }
    function closeModal() {
        document.getElementById('dataModal').style.display = 'none';
    }
    window.onclick = function(event) {
        const modal = document.getElementById('dataModal');
        if (event.target === modal) closeModal();
    };

    // ========== Auto-calculation functions ==========
    function calculateAge() {
        const birthDateInput = document.querySelector('input[name="birthDate"]');
        const ageInput = document.querySelector('input[name="age"]');
        const retirementYearInput = document.querySelector('input[name="retirementYear"]');
        if (birthDateInput && ageInput && retirementYearInput && birthDateInput.value) {
            const birthDate = new Date(birthDateInput.value);
            const today = new Date();
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) age--;
            ageInput.value = age;
            retirementYearInput.value = birthDate.getFullYear() + 60;
        }
    }
    function calculateWorkExperience() {
        const startDateInput = document.querySelector('input[name="startDate"]');
        const workExperienceInput = document.querySelector('input[name="workExperience"]');
        if (startDateInput && workExperienceInput && startDateInput.value) {
            const startDate = new Date(startDateInput.value);
            const today = new Date();
            let years = today.getFullYear() - startDate.getFullYear();
            let months = today.getMonth() - startDate.getMonth();
            if (months < 0) { years--; months += 12; }
            if (today.getDate() < startDate.getDate()) { months--; if (months < 0) { years--; months += 12; } }
            let experienceText = '';
            if (years > 0) experienceText += years + ' ‡∏õ‡∏µ';
            if (months > 0) experienceText += (experienceText ? ' ' : '') + months + ' ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô';
            if (!experienceText) experienceText = '‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô';
            workExperienceInput.value = experienceText;
        }
    }

    // ========== Form submit ==========
    document.getElementById('staffForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        Swal.fire({
            title: window.isUpdateMode ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...' : '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
            html: `<div class="flex flex-col items-center space-y-4"><div class="loading-spinner"></div></div>`,
            allowOutsideClick: false, showConfirmButton: false,
            didOpen: () => { Swal.showLoading(); }
        });
        try {
            const form = this;
            const originalFormData = new FormData(form);
            // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const personnelData = {
                action: window.isUpdateMode ? 'update' : 'create',
                originalIdCard: window.currentData?.idCard || originalFormData.get('idCard'),
                idCard: originalFormData.get('idCard') || '',
                department: originalFormData.get('department') || '',
                positionId: originalFormData.get('positionNumber') || '',
                prefix: originalFormData.get('prefix') || '',
                fullName: originalFormData.get('fullName') || '',
                position: originalFormData.get('position') || '',
                positionLevel: originalFormData.get('positionLevel') || '',
                positionType: originalFormData.get('positionType') || '',
                positionExpertise: originalFormData.get('expertise') || '',
                birthDate: originalFormData.get('birthDate') || '',
                licenseNumber: originalFormData.get('licenseNumber') || '',
                nursingCouncilNumber: originalFormData.get('nursingCouncilNumber') || '',
                licenseExpiry: originalFormData.get('licenseExpiry') || '',
                startWorkDate: originalFormData.get('startDate') || '',
                appointmentDate: originalFormData.get('appointmentDate') || '',
                specialistDate: originalFormData.get('specialistDate') || '',
                retirementYear: originalFormData.get('retirementYear') || '',
                phone: originalFormData.get('phone') || '',
                email: originalFormData.get('email') || '',
                education: originalFormData.get('educationLevel') || '',
                bachelorDegree: originalFormData.get('bachelorField') || '',
                masterDegree: originalFormData.get('masterField') || '',
                doctoralDegree: originalFormData.get('doctoralField') || '',
                specializedNursing: originalFormData.get('specializedNursing') || '',
                workType: originalFormData.get('workType') || '',
                age: originalFormData.get('age') || '',
                workAge: originalFormData.get('workExperience') || '',
                licenseExpiryDate: originalFormData.get('licenseExpiry') || ''
            };
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á FormData ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á (‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå)
            const formData = new FormData();
            Object.keys(personnelData).forEach(key => formData.append(key, personnelData[key]));
            ['personalImage', 'licenseDocument', 'educationDocument', 'specializedDocument'].forEach(fieldName => {
                const file = originalFormData.get(fieldName);
                if (file && file.size > 0) formData.append(fieldName, file);
            });

            const response = await fetch(SCRIPT_URL, { method: 'POST', body: formData });
            const responseText = await response.text();
            let responseData = null;
            let success = false;
            try {
                responseData = JSON.parse(responseText);
                success = responseData.success === true;
            } catch (parseError) {
                success = response.ok && (responseText.includes('success') || responseText.includes('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'));
            }
            Swal.close();
            if (success) {
                window.currentData = personnelData;
                await Swal.fire({
                    icon: 'success',
                    title: window.isUpdateMode ? '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!' : '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                    text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
                    confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                    confirmButtonColor: '#10b981',
                    timer: 3000,
                    timerProgressBar: true
                });
                if (!window.isUpdateMode) {
                    window.hasSubmittedBefore = true;
                    document.querySelector('button[type="submit"]').innerHTML = '<i class="fas fa-sync-alt mr-3 animate-spin text-yellow-600"></i>‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                    document.querySelector('button[type="submit"]').className = 'flex-1 bg-gradient-to-r from-orange-300 to-red-300 hover:from-orange-400 hover:to-red-400 text-black font-semibold py-4 px-6 rounded-lg transition-all duration-300 flex items-center justify-center text-lg shadow-lg';
                    document.getElementById('clearFormBtn').style.display = 'flex';
                    window.isUpdateMode = true;
                }
            } else {
                await Swal.fire({
                    icon: 'error',
                    title: '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                    html: `<div class="text-lg"><p class="mb-2">‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ</p><p class="text-red-600 font-semibold">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>${responseData && responseData.message ? `<p class="text-sm text-gray-600 mt-2">‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${responseData.message}</p>` : ''}</div>`,
                    confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                    confirmButtonColor: '#ef4444'
                });
            }
        } catch (error) {
            Swal.close();
            await Swal.fire({
                icon: 'error',
                title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
                html: `<div class="text-lg"><p class="mb-2">‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ</p><p class="text-red-600 font-semibold">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</p><p class="text-sm text-gray-600 mt-2">‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}</p></div>`,
                confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                confirmButtonColor: '#ef4444'
            });
        }
    });

    // ========== ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å dropdown ‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ==========
    document.addEventListener('DOMContentLoaded', function() {
        loadDropdownData();
    });
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'983f79bb85cb2dd4',t:'MTc1ODY4NzQ4Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
